(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     22369,        568]
NotebookOptionsPosition[     21707,        542]
NotebookOutlinePosition[     22043,        557]
CellTagsIndexPosition[     22000,        554]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.62763635660709*^9, 3.627636364202533*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   FractionBox["1", "GoldenRatio"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fib", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"IntegerPart", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "+", "1"}], ")"}], "\[Omega]"}], "]"}], "-", 
    RowBox[{"IntegerPart", "[", 
     RowBox[{"i", " ", "\[Omega]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.625821275395328*^9, 3.625821289767605*^9}, {
  3.6259819487383623`*^9, 3.6259819488686132`*^9}, {3.625982154231119*^9, 
  3.625982158181548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"chain", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "11"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"Fibonacci", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stiffness", " ", "couplings"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta", "=", "5."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stiff", "[", "i_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"delta", "*", 
        RowBox[{"fib", "[", 
         RowBox[{"i", "-", "1"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"harmonic", " ", "mean", " ", "stiffness"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meank", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "delta"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"delta", "*", 
         RowBox[{
          RowBox[{"Fibonacci", "[", 
           RowBox[{"n", "-", "2"}], "]"}], "/", 
          RowBox[{"Fibonacci", "[", "n", "]"}]}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[CapitalOmega]", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"stiff", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "+", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"diag", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"stiff", "[", "1", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"diag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"subdiag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]2", "=", 
     RowBox[{"subdiag\[CapitalOmega]2", "+", 
      RowBox[{"Transpose", "[", "subdiag\[CapitalOmega]2", "]"}], "+", 
      "diag\[CapitalOmega]2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"periodic", " ", "\[CapitalOmega]", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
        RowBox[{"-", "meank"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
        RowBox[{"2", " ", "meank"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"diag", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "meank"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"diag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"subdiag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]p2", "=", 
     RowBox[{"subdiag\[CapitalOmega]2", "+", 
      RowBox[{"Transpose", "[", "subdiag\[CapitalOmega]2", "]"}], "+", 
      "diag\[CapitalOmega]2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625981976841827*^9, 3.625981983026157*^9}, {
   3.625982084377492*^9, 3.6259821984070673`*^9}, {3.625982229990522*^9, 
   3.625982281364909*^9}, {3.625982313258505*^9, 3.625982429768948*^9}, {
   3.62598255838474*^9, 3.6259827850194683`*^9}, {3.6259828164294558`*^9, 
   3.625982819019476*^9}, {3.625982866683402*^9, 3.6259829336084957`*^9}, {
   3.6259950660603848`*^9, 3.625995152956738*^9}, {3.6259952363722467`*^9, 
   3.625995236513494*^9}, {3.6259953296015472`*^9, 3.6259954106773577`*^9}, {
   3.625999601034926*^9, 3.625999655082347*^9}, {3.625999817712805*^9, 
   3.625999890579364*^9}, {3.62599992156425*^9, 3.6259999335304947`*^9}, 
   3.625999980860647*^9, {3.627636250535138*^9, 3.627636250657825*^9}, {
   3.627664663988325*^9, 3.6276647532201147`*^9}, {3.6276648161841793`*^9, 
   3.6276648604433203`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eigmod", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Eigenvalues", "[", "\[CapitalOmega]2", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigmodp", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Eigenvalues", "[", "\[CapitalOmega]p2", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.625995191256486*^9, 3.62599521032939*^9}, {
  3.6259996825133142`*^9, 3.6259996882578907`*^9}, {3.625999777107383*^9, 
  3.6259997798410273`*^9}, {3.6259998666906157`*^9, 3.625999891825688*^9}, {
  3.627664867450499*^9, 3.627664894334866*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eigmod", ",", "eigmodp"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "0.01", "]"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<n\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Eigenfrequencies of the Fibonacci chain\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"dir", "<>", "\"\<data/eigenmodes.pdf\>\""}], ",", "%"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6259952122837143`*^9, 3.625995227018426*^9}, {
   3.625999608433968*^9, 3.625999609089161*^9}, {3.625999657794628*^9, 
   3.625999659009557*^9}, 3.6259997842585993`*^9, {3.627636256521516*^9, 
   3.627636321595729*^9}, {3.627636378011784*^9, 3.627636455804171*^9}, {
   3.62763652444663*^9, 3.62763657471786*^9}, {3.627664898196454*^9, 
   3.6276649021060257`*^9}, {3.627664965879825*^9, 3.627664970919681*^9}, {
   3.6276650055691643`*^9, 3.627665007922611*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.24720000000000014`, 0.24, 0.6], PointSize[0.01], 
     PointBox[CompressedData["
1:eJw91H1MU1ccxvHrNkdhFGRikKDENaCAqDBmxQLrU14KtFDa0jIHLJtkHZFJ
kGwDF+PoRrIXFyED3KbRiiWkqwmJQeYMi9jEWTsF54BYhaxrnWMUhLYg4KyQ
sXB+nOTm5HO/ef49r1TUqHXPcRz35vL3/71yvOLkOxrFLP+UmP1AsvBRUM2X
F5l56JZEtLVlWpjXYe2A4cB0n5U5HNaUjp+PpAwwb8TXAREB7uu/M2+CNOTZ
dPr8MPMW4I+eKdvz95gFsLUMjPrfHWWOweRdj/BGjYN5KzpjNvM8PziZ41A9
87T7QuoD5gTMWj7YlX7hL+ZEpJqUPGHU38w7scNfur6xZYw5CaN7mktvXPmH
ORldl9r3f6pzM7+K22M9tvnWCeYULIX3XwmsnGR+DUbD5cInrY+Yd+OtkQ26
xtgpZiFKrGHfOy56mfcgwG/kjwf7mFOxN/6SUpxH3gvXgotn7yeLYNgUfvK3
mhnmNHR2VNWVHyOn452yI55IHzkD7hihYyhylvl19AaN6cwdZDGs39Wae+1k
4PbO/V0hbmY9sMM1EXjmxcesSxD9y7nFJsUc6xKcr3/ZyLP4Wc+E+T1Br7z0
Baz0TIicz671kbksGAYO/frVAepZsI5Uyt+uop6Nus/mwH+fejZ8m0O23z9K
PQcaXVv5R59Qz8GJLd7Guq1rWZciazy8Xb6NWS9F9JMR01wC9VwInLEfHkui
ngsu235vXzL1PPR+ezapNod6Hsz9Dd6jTur5MN4vWHKR9fkYEleul3upy3Bw
jcw/RNbLEGBavCrxUZeDf0caVbFIXY7DieVCM5krgK7W2x3hDGa9ANWSWamC
zBXi1jj6jKu9EBU33V1wUVeg/qHn2mmyXoE40fDjxCnqRehcmGkvI+uLsFud
5qha7UpwBx2Vqn+ZoUQLjz96nKxXIqr+Y9kk2bLcFcGTh57SXoUg/dUUGxkq
NIeGndy4/C6s7FXwTMiqB0PD2F4F0Ut+4RCZU6P9sHnD8XXMUCPa01DXRNar
0VCS0NpMtqhRsDD8sDSM9sUwqaNtZWQU4+78RFrcNtoXo+hEW0882VIMkT3x
QQaZ0yBSKTuvJUODqJ92Cd5Y3WvwY1/gYHkc7TUY/ma7zyCivRaxGYOdZ8nQ
okj6RWhuGu21yDc1CfLIFi3sY5+vySdzJZg+51j6k4wSVF+OP+1c9n+F3Iga

      "]]}, 
    {RGBColor[0.6, 0.24, 0.4428931686004542], PointSize[0.01], 
     PointBox[CompressedData["
1:eJw1yw9M1GUcx/EfnAIGZlIqlQ1kBAfBiQThIXgfTuAOgfP+oV1yRbgDEQXv
CGqp9BsO/yHEEDNjzGTDhUVKYLEhSYInU+SGK4FyTo4IhHGCyAkXRjW+z297
9tvreT+fdRl5aoMzx3G6/87//8VvUmKqcVoe3nNWQhcIWVHT4/deE9kNu5Zk
z33l3U5+CV6j2pUPKszkV2BtWler4+6QvXBJbBi88WMveS02r4lKmxv/lewD
2U4tf8S7n+yLcN7cEKz6g+yHeu9lOd/yD8j+8Ix2ixi895AsxG3pJbPXXis5
CEW1xwrvLwyRg6H+wL7Po3KYLIItMtR+zHeEHIq/+jo+DWscJW/AmNbz5KOY
MXIYqjtvDZZ3jZPfxmzLh3qBaoIcjnJjiYewz0aOwITs5qq8kEnyOxgvt58S
2Jgj8eXvcpW0YYq8EWeSAsVrc56QxYiT+muKA6bJUSiu9O40WJk3oS/LZPmp
+ik5GlO/+PZna2bIMdCZnDP2LbOTN+Pu4d88m9uYJTj+NL9p/f5nZGDDd6Oh
d31mF80DyWfKasosZC4Web1+YdqDc9RjsbrLpvAKcFCXIgttB7stZF4KS6Ag
d1fh39S3oEI4uGB5bZ76Fuy9Ltq0tI3MxUH0Kp9qT3tOPQ5Tbwh/+MJB5uLh
Fhg5NHD6H+rxUFoLLjaJFqgnQJGZ5lhzg8wnQHyr+MChYA6LXYbvxZ8fEBaQ
eRne6t4tPXqVdTkaJDvWVzk7UZejJT3haqKMzCWitTSiqPYE64kYdq9782w3
61vRoXD6TLjcmfpWhP7pnp+UTOaSkCaVuj4/znoSLPHS9zeaWU+G3hDcMssJ
qCfjcKUgXxxF5lJg+PkFd7uR9RREz3u/HvQN6woMiVfpe++zrkDpUZeLIyuW
UN+GkZEGx+5YMr8N8+ebs1RG1pVIf9E5qOYcGUpUDbhWy7vZeyUOXXGPUD4j
tysR8lHuqcs+S2mvQuaRSVOmnAwVdP3Tjbm5ZF6F866tSnMluV2FyIk6454r
bK/GUGGO7t17bK+G/rYyr2yG7dWYbtbHuL7sQns1TIry/R0iMqdBrs1p4Jqc
DA12pATscaSTeQ2+tg5HGT9mew3GCjpLfE+yvRZ+gx71HufYXosL3IS/6DLb
a/Gwp6qu5Brba7G6XvV45R22T0VY64Unvf1sn4rsiozrnVa2T8UnNxtPPxpj
+1SUjoq6JFNsvx2jOx8PmGfYfjvc+LK8olkX/AtuY4UR
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"n\"", TraditionalForm], 
    FormBox[
    "\"\\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  Method->{},
  PlotLabel->FormBox[
   "\"Eigenfrequencies of the Fibonacci chain\"", TraditionalForm],
  PlotRange->{{0, 89.}, {0, 4.308474006697094}},
  PlotRangeClipping->True,
  PlotRangePadding->{{1.78, 1.78}, {0.08616948013394188, 
   0.08616948013394188}}]], "Output",
 CellChangeTimes->{{3.625995216500298*^9, 3.6259952408136797`*^9}, {
   3.625995377680015*^9, 3.62599541326827*^9}, {3.625999603561874*^9, 
   3.625999659705276*^9}, 3.6259996903469257`*^9, 3.625999784769264*^9, {
   3.62599989854655*^9, 3.625999938556897*^9}, 3.625999985462491*^9, {
   3.627636229648204*^9, 3.6276363219826717`*^9}, 3.6276363718382874`*^9, {
   3.6276364357272453`*^9, 3.627636456551043*^9}, {3.627636535400865*^9, 
   3.6276365750643053`*^9}, 3.6276649024924383`*^9, 3.6276650090048103`*^9}],

Cell[BoxData["\<\"/home/nicolas/git/classical-quasicrystals/data/eigenmodes.\
pdf\"\>"], "Output",
 CellChangeTimes->{{3.625995216500298*^9, 3.6259952408136797`*^9}, {
   3.625995377680015*^9, 3.62599541326827*^9}, {3.625999603561874*^9, 
   3.625999659705276*^9}, 3.6259996903469257`*^9, 3.625999784769264*^9, {
   3.62599989854655*^9, 3.625999938556897*^9}, 3.625999985462491*^9, {
   3.627636229648204*^9, 3.6276363219826717`*^9}, 3.6276363718382874`*^9, {
   3.6276364357272453`*^9, 3.627636456551043*^9}, {3.627636535400865*^9, 
   3.6276365750643053`*^9}, 3.6276649024924383`*^9, 3.6276650091050053`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"chain", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "13"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"Fibonacci", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stiffness", " ", "couplings"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta", "=", "1."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stiff", "[", "i_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"delta", "*", 
        RowBox[{"fib", "[", 
         RowBox[{"i", "-", "1"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[CapitalOmega]", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"stiff", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "+", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"diag", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"stiff", "[", "1", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"diag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"subdiag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]2", "=", 
     RowBox[{"subdiag\[CapitalOmega]2", "+", 
      RowBox[{"Transpose", "[", "subdiag\[CapitalOmega]2", "]"}], "+", 
      "diag\[CapitalOmega]2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diageigmod", "=", 
     RowBox[{"Sort", "@", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]2", "-", 
         RowBox[{"DiagonalMatrix", "@", 
          RowBox[{"Diagonal", "[", "\[CapitalOmega]2", "]"}]}]}], ")"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"diageigmod", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<n\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(hd\)], \
\(n\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Eigenvalues of the kinetic part \\n of the Hamiltonian: \
self-similarity.\>\""}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"dir", "<>", "\"\<data/kinetic_self_similar.pdf\>\""}], ",", 
     "%"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.627636739071419*^9, 3.627636833690198*^9}, {
  3.6276368771076*^9, 3.627636878020563*^9}, {3.627636916979822*^9, 
  3.6276370476826363`*^9}, {3.627637082149194*^9, 3.627637096820983*^9}, {
  3.627637146524787*^9, 3.627637146692733*^9}, {3.627665020948909*^9, 
  3.627665023054412*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], Thickness[0.003], 
    LineBox[CompressedData["
1:eJw1lwtQlWUaxw8UIpDojAwJOAroKkGaImJchD/IXUQ43O+Hc+NcAKv1hhUe
DW3B3Eyr1cxWvNZqpeAmlMbJNmcbZ73tiBSC4BUTGzXXSY1tXZ//ywzD/HjO
//zO+b7vfd/nCdIv0ppcNRrNjce///8rP7fj0/9lcUGVp5P/wPH7AV1NOsUj
sa2qKfJSmeIx2KwZ/x97qWIf+A0tXXqpWPE4vJfy/ssrtIrHY/O1d8+nZysO
RF9PnX9qjOJgRGY2BqVEKZ6MTwu/0/pEKp6C7sVftPs+rzgEv94t6L0SojgU
H6UEj943RfHzqHQ1bGsd9iBPx8f+kT+ve6B4Bjp0FWdbBhXPhC7I9eGzVxSH
w1zT+lTtRcWzUPRm3M6NZxRHYM3E9YFvnFQ8G/Uf5DT0xSqORPCo5MzWKMVz
YG33aEqfrfhFlD36Y+ahPyiOwi8z157znqg4Gr6WxR2OcYpjEOjj/9P5OyPJ
sWj9s/WUy0+K58Le9dy3nx1XHIf+lwrW3XAqjsemAwEJD9sVA/GDPomaT8gO
YJHDb2DfLlVPgMtfdj/b3KLqCZid6vHimHp31hPh2LXiQOxisiMR14/tvOxV
rurzEDBgHdGep+rzkHQtd4cmU9WTUFsyuKo1RNWTEHojvFo/UdWTEftOveXW
NyNYT0ZtRndywBGyJgXeq/aE3zyo6inwz7p56q+bVD0VH2Z7lY9oVvVUnIiZ
XvjNalVPQ8+phjsZEaqeBuPd7Vtvhql6Okbt7lj3jLeqp2P5hKuNDe6qnoHR
JW8139aoegbW11yfFnfbjfX5iE740uPWENkxH2fHD9c72lxZz8TlXken9gWy
IxMeX89qXhSm6guwd8a2SWlBqr4A+v3R93b5qHoW0obCP+72VPUseEVNzl15
wYX1hRh5dOgt82myYyH8bvad7zug6tmIvlhi2rKWjGyMP5j4WtAy9fpsNH5f
4HmyhOzMxs+PPP1ezlD5HHRH6HJGJqh8Dias+qLxkUnDfA7mTNXknyklO3NQ
+2pW5+fhZI0WPa1b/A5PJkOLY3t8Yzx8VF6LaF3v2+e+/71T8lps8AnNfLuN
rMnFD3WvB7vd+a8wchH6dI+tdibZkYutFy/EaSeQnblYYVvp9t0vw8znYfiZ
oh2HT5CRhzkpGaGvHSQ78pDnfuNe8Fyy8/Hryzomj3hO5fOxdsMoU727yuej
4Nehi+f+/Rvz+Rg+UXzE7x9kZz7cYtsWfvYpWVOAlPA1c5a1kFGA+B9dHh7f
qvIFuLJ6adTpqVeYL8C6qz9s+tKPrCnEg42Fhs6zl5kvxKy2eF3DYbKjEDrD
3s6Zm8nOQsRNG7NvuSdZU4Sj3WPvawcuMV+Ev9uXtEU3DTBfhAXzV7xvzyQ7
i7CsL3zafG+yphgb2gYHEpf0M1+Mvn9uvf91BNlRjCTfoOuRLmRnMT7Q5u13
hPQwX4L6q4ueavz8R+ZLcNs4uzXrSjfzJahzCw/rtZKdJfhT687re7vPM1+K
5uG6CB9LF/OleGFHe1f/OLKjFKPvNXuc/Og086XwX5Mas83QznwZjqYOFNwM
Psx8Ga59OP33kPxDzJfhlOeh3RdeOsB8GbboEybu2b2P+XJMMS4Pe6euifly
eBfvj2pa/ckRyZej3fCkHi/5cmyXvLCmAl3y/sKowKD4hR0VOCOfj/kKTJXP
z3wlvOT7MV+JGfL9ma/Eerk+zFfiTbl+zOvgkOsrHKjDPbn+fD8dXpH7I6zT
4V25f3x/nbq/wtt16JX7T58Om+T5EO7XYYk8P/RXIU2eL/qr8JU8f/RXoUOe
T/qrMFeeX/qrUCHPN/1ViJXnn/4qPJT1QX8V1sv6oV+Py7K+6NcjRtYf/Xok
yvqkX4/hmCfrl349Hsj6pl+PBbL+6ddjuewP9OtxV/YP+g3IlP2FfgMg+w/9
BmhGPdmf6DfgVdm/6Deo/Y1+A8Jk/6PfgNOyP9JvwGbZP+k3Yp7sr/Qb8a3s
vxC/ERdlfxbWGdX+LewwIkb2d+HtRkyS/V/YaUSXnA/C/UbckvNDWGPCSjlf
hANNCJbzh34TIOcT/Sb4yvlFvwlPy/lGvwnucv7Rb8JCOR/pN8Eg5yf9ZuyR
85V+M9zl/KXfjEtyPtNvRpec3/Sb1flOvxkb5fyn3wwv6Q/oN2Op9A/0V8ND
+gv6q2GW/oP+avRJf0J/Nc5I/0J/NVqkv6G/GpOk/6G/GmOlP6K/Gq9I/0S/
BfOkv6LfgqnSf9FvgVX6M/otSJH+jX4LJkh/R78Ft6T/o9+CBukP6bcgQvpH
+q1wlf6SfqvqP+m3Ik76U/qt2CL9K/1WXJX+ln4rbNL/0m9V/TH9VgRJ/0y/
DWOlv6bfhnvSf9NvQ6n05/TboJf+nX4bAqW/p9+G16X/p9+GN2Q+oN+GPJkf
6LfDLvMF/XboZf6g346vZD6h346/yfxC/+PXy3xDv13NP/Tb8ZvMR/Tb0Svz
E/01aJP5iv4aJMn8RX8Nrsl8Rn8NNsr8Rv9jlvmO/hoEyPxHfw3ek/mQ/hq0
yPxIfy2OyXxJfy2SZf7E/wAjqjn2
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"n\"", TraditionalForm], 
    FormBox[
    "\"\\!\\(\\*SubscriptBox[SuperscriptBox[\\(T\\), \\(hd\\)], \
\\(n\\)]\\)\"", TraditionalForm]},
  AxesOrigin->{0, 0.},
  Method->{},
  PlotLabel->FormBox[
   "\"Eigenvalues of the kinetic part \\n of the Hamiltonian: \
self-similarity.\"", TraditionalForm],
  PlotRange->{{0, 233.}, {-3.297485362063217, 3.2974853620632154`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{4.66, 4.66}, {0.13189941448252865`, 
   0.13189941448252865`}}]], "Output",
 CellChangeTimes->{{3.627636772255084*^9, 3.627636834122182*^9}, {
   3.627636927491984*^9, 3.627636933613858*^9}, {3.6276369794744787`*^9, 
   3.627637048560357*^9}, {3.627637089686977*^9, 3.627637097515329*^9}, 
   3.627637147231167*^9, 3.627665023555043*^9}],

Cell[BoxData["\<\"/home/nicolas/git/classical-quasicrystals/data/kinetic_self_\
similar.pdf\"\>"], "Output",
 CellChangeTimes->{{3.627636772255084*^9, 3.627636834122182*^9}, {
   3.627636927491984*^9, 3.627636933613858*^9}, {3.6276369794744787`*^9, 
   3.627637048560357*^9}, {3.627637089686977*^9, 3.627637097515329*^9}, 
   3.627637147231167*^9, 3.627665023761784*^9}]
}, Open  ]]
},
WindowSize->{1920, 1028},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 174, 4, 32, "Input"],
Cell[735, 26, 597, 16, 73, "Input"],
Cell[1335, 44, 5945, 166, 495, "Input"],
Cell[7283, 212, 663, 16, 55, "Input"],
Cell[CellGroupData[{
Cell[7971, 232, 1172, 27, 55, "Input"],
Cell[9146, 261, 3779, 70, 274, "Output"],
Cell[12928, 333, 610, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13575, 346, 4142, 117, 388, "Input"],
Cell[17720, 465, 3598, 67, 281, "Output"],
Cell[21321, 534, 370, 5, 88, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
