(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23354,        575]
NotebookOptionsPosition[     22470,        541]
NotebookOutlinePosition[     22804,        556]
CellTagsIndexPosition[     22761,        553]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.62763635660709*^9, 3.627636364202533*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   FractionBox["1", "GoldenRatio"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fib", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"IntegerPart", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "+", "1"}], ")"}], "\[Omega]"}], "]"}], "-", 
    RowBox[{"IntegerPart", "[", 
     RowBox[{"i", " ", "\[Omega]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.625821275395328*^9, 3.625821289767605*^9}, {
  3.6259819487383623`*^9, 3.6259819488686132`*^9}, {3.625982154231119*^9, 
  3.625982158181548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"chain", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "13"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"Fibonacci", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Fibonacci", "[", 
      RowBox[{"n", "-", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Fibonacci", "[", 
      RowBox[{"n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stiffness", " ", "couplings"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ks", "=", "3."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kw", "=", "2.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stiff", "[", "i_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"p", " ", "i"}], ",", 
          RowBox[{"p", "+", "q"}]}], "]"}], "\[GreaterEqual]", "p"}], ",", 
       "kw", ",", "ks"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[CapitalOmega]", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"stiff", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "+", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"diag", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"stiff", "[", "1", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"diag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"subdiag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]2", "=", 
     RowBox[{"subdiag\[CapitalOmega]2", "+", 
      RowBox[{"Transpose", "[", "subdiag\[CapitalOmega]2", "]"}], "+", 
      "diag\[CapitalOmega]2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625981976841827*^9, 3.625981983026157*^9}, {
   3.625982084377492*^9, 3.6259821984070673`*^9}, {3.625982229990522*^9, 
   3.625982281364909*^9}, {3.625982313258505*^9, 3.625982429768948*^9}, {
   3.62598255838474*^9, 3.6259827850194683`*^9}, {3.6259828164294558`*^9, 
   3.625982819019476*^9}, {3.625982866683402*^9, 3.6259829336084957`*^9}, {
   3.6259950660603848`*^9, 3.625995152956738*^9}, {3.6259952363722467`*^9, 
   3.625995236513494*^9}, {3.6259953296015472`*^9, 3.6259954106773577`*^9}, {
   3.625999601034926*^9, 3.625999655082347*^9}, {3.625999817712805*^9, 
   3.625999890579364*^9}, {3.62599992156425*^9, 3.6259999335304947`*^9}, 
   3.625999980860647*^9, {3.627636250535138*^9, 3.627636250657825*^9}, {
   3.642764336358047*^9, 3.642764336500719*^9}, {3.642764372916699*^9, 
   3.6427644667264643`*^9}, {3.642764540295396*^9, 3.642764546214072*^9}, 
   3.642764603493938*^9, {3.6427646719423027`*^9, 3.6427646823253202`*^9}, {
   3.642764825765925*^9, 3.6427648511569347`*^9}, {3.6427648858621492`*^9, 
   3.642764887765732*^9}, {3.642764954325882*^9, 3.642764956389277*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eigmod", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Eigenvalues", "[", "\[CapitalOmega]2", "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.625995191256486*^9, 3.62599521032939*^9}, {
  3.6259996825133142`*^9, 3.6259996882578907`*^9}, {3.625999777107383*^9, 
  3.6259997798410273`*^9}, {3.6259998666906157`*^9, 3.625999891825688*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"eigmod", ",", 
   RowBox[{"Joined", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "0.01", "]"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<n\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<Eigenmodes of the Fibonacci chain\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"dir", "<>", "\"\<data/eigenmodes.pdf\>\""}], ",", "%"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6259952122837143`*^9, 3.625995227018426*^9}, {
   3.625999608433968*^9, 3.625999609089161*^9}, {3.625999657794628*^9, 
   3.625999659009557*^9}, 3.6259997842585993`*^9, {3.627636256521516*^9, 
   3.627636321595729*^9}, {3.627636378011784*^9, 3.627636455804171*^9}, {
   3.62763652444663*^9, 3.62763657471786*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
      "]]}, {}}, {}},
  
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"n\"", TraditionalForm], 
    FormBox[
    "\"\\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotLabel->FormBox["\"Eigenmodes of the Fibonacci chain\"", TraditionalForm],
  PlotRange->{{0., 233.}, {0, 3.4640232315796413`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.625995216500298*^9, 3.6259952408136797`*^9}, {
   3.625995377680015*^9, 3.62599541326827*^9}, {3.625999603561874*^9, 
   3.625999659705276*^9}, 3.6259996903469257`*^9, 3.625999784769264*^9, {
   3.62599989854655*^9, 3.625999938556897*^9}, 3.625999985462491*^9, {
   3.627636229648204*^9, 3.6276363219826717`*^9}, 3.6276363718382874`*^9, {
   3.6276364357272453`*^9, 3.627636456551043*^9}, {3.627636535400865*^9, 
   3.6276365750643053`*^9}, {3.642764329122396*^9, 3.642764338878373*^9}, {
   3.642764456940184*^9, 3.642764469718458*^9}, {3.642764543104582*^9, 
   3.642764548382037*^9}, 3.642764605765174*^9, {3.6427646766810503`*^9, 
   3.642764684564971*^9}, {3.642764829538042*^9, 3.642764853215641*^9}, 
   3.642764890208276*^9}],

Cell[BoxData["\<\"/home/nicolas/git/dynamics_classical_qp_chain/data/\
eigenmodes.pdf\"\>"], "Output",
 CellChangeTimes->{{3.625995216500298*^9, 3.6259952408136797`*^9}, {
   3.625995377680015*^9, 3.62599541326827*^9}, {3.625999603561874*^9, 
   3.625999659705276*^9}, 3.6259996903469257`*^9, 3.625999784769264*^9, {
   3.62599989854655*^9, 3.625999938556897*^9}, 3.625999985462491*^9, {
   3.627636229648204*^9, 3.6276363219826717`*^9}, 3.6276363718382874`*^9, {
   3.6276364357272453`*^9, 3.627636456551043*^9}, {3.627636535400865*^9, 
   3.6276365750643053`*^9}, {3.642764329122396*^9, 3.642764338878373*^9}, {
   3.642764456940184*^9, 3.642764469718458*^9}, {3.642764543104582*^9, 
   3.642764548382037*^9}, 3.642764605765174*^9, {3.6427646766810503`*^9, 
   3.642764684564971*^9}, {3.642764829538042*^9, 3.642764853215641*^9}, 
   3.642764890442665*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "*", 
   SqrtBox["ks"]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.642764861749495*^9, 3.642764883230865*^9}}],

Cell[BoxData["3.4641016151377544`"], "Output",
 CellChangeTimes->{{3.625995216500298*^9, 3.6259952408136797`*^9}, {
   3.625995377680015*^9, 3.62599541326827*^9}, {3.625999603561874*^9, 
   3.625999659705276*^9}, 3.6259996903469257`*^9, 3.625999784769264*^9, {
   3.62599989854655*^9, 3.625999938556897*^9}, 3.625999985462491*^9, {
   3.627636229648204*^9, 3.6276363219826717`*^9}, 3.6276363718382874`*^9, {
   3.6276364357272453`*^9, 3.627636456551043*^9}, {3.627636535400865*^9, 
   3.6276365750643053`*^9}, {3.642764329122396*^9, 3.642764338878373*^9}, {
   3.642764456940184*^9, 3.642764469718458*^9}, {3.642764543104582*^9, 
   3.642764548382037*^9}, 3.642764605765174*^9, {3.6427646766810503`*^9, 
   3.642764684564971*^9}, {3.642764829538042*^9, 3.642764891782619*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eigmod", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.642764871665255*^9, 3.642764874974275*^9}}],

Cell[BoxData["3.428349698954142`"], "Output",
 CellChangeTimes->{{3.642764875360022*^9, 3.642764892879992*^9}, 
   3.6427649628904743`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"chain", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "13"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"Fibonacci", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stiffness", " ", "couplings"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta", "=", "1."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stiff", "[", "i_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"delta", "*", 
        RowBox[{"fib", "[", 
         RowBox[{"i", "-", "1"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[CapitalOmega]", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"stiff", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "+", 
         RowBox[{"stiff", "[", "i", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"diag", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"stiff", "[", "1", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"diag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subdiag\[CapitalOmega]2", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"subdiag", ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]2", "=", 
     RowBox[{"subdiag\[CapitalOmega]2", "+", 
      RowBox[{"Transpose", "[", "subdiag\[CapitalOmega]2", "]"}], "+", 
      "diag\[CapitalOmega]2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diageigmod", "=", 
     RowBox[{"Sort", "@", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]2", "-", 
         RowBox[{"DiagonalMatrix", "@", 
          RowBox[{"Diagonal", "[", "\[CapitalOmega]2", "]"}]}]}], ")"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"diageigmod", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<n\>\"", ",", "\"\<\!\(\*SubscriptBox[\(T\), \(n\)]\)\>\""}], 
       "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Eigenvalues of the kinetic part \\n of the Hamiltonian: \
self-similarity.\>\""}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"dir", "<>", "\"\<data/kinetic_self_similar.pdf\>\""}], ",", 
     "%"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.627636739071419*^9, 3.627636833690198*^9}, {
  3.6276368771076*^9, 3.627636878020563*^9}, {3.627636916979822*^9, 
  3.6276370476826363`*^9}, {3.627637082149194*^9, 3.627637096820983*^9}, {
  3.627637146524787*^9, 3.627637146692733*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
    Thickness[0.003], LineBox[CompressedData["
1:eJw1lwtQlWUaxw8UIpDojAwJOAroKkGaImJchD/IXUQ43O+Hc+NcAKv1hhUe
DW3B3Eyr1cxWvNZqpeAmlMbJNmcbZ73tiBSC4BUTGzXXSY1tXZ//ywzD/HjO
//zO+b7vfd/nCdIv0ppcNRrNjce///8rP7fj0/9lcUGVp5P/wPH7AV1NOsUj
sa2qKfJSmeIx2KwZ/x97qWIf+A0tXXqpWPE4vJfy/ssrtIrHY/O1d8+nZysO
RF9PnX9qjOJgRGY2BqVEKZ6MTwu/0/pEKp6C7sVftPs+rzgEv94t6L0SojgU
H6UEj943RfHzqHQ1bGsd9iBPx8f+kT+ve6B4Bjp0FWdbBhXPhC7I9eGzVxSH
w1zT+lTtRcWzUPRm3M6NZxRHYM3E9YFvnFQ8G/Uf5DT0xSqORPCo5MzWKMVz
YG33aEqfrfhFlD36Y+ahPyiOwi8z157znqg4Gr6WxR2OcYpjEOjj/9P5OyPJ
sWj9s/WUy0+K58Le9dy3nx1XHIf+lwrW3XAqjsemAwEJD9sVA/GDPomaT8gO
YJHDb2DfLlVPgMtfdj/b3KLqCZid6vHimHp31hPh2LXiQOxisiMR14/tvOxV
rurzEDBgHdGep+rzkHQtd4cmU9WTUFsyuKo1RNWTEHojvFo/UdWTEftOveXW
NyNYT0ZtRndywBGyJgXeq/aE3zyo6inwz7p56q+bVD0VH2Z7lY9oVvVUnIiZ
XvjNalVPQ8+phjsZEaqeBuPd7Vtvhql6Okbt7lj3jLeqp2P5hKuNDe6qnoHR
JW8139aoegbW11yfFnfbjfX5iE740uPWENkxH2fHD9c72lxZz8TlXken9gWy
IxMeX89qXhSm6guwd8a2SWlBqr4A+v3R93b5qHoW0obCP+72VPUseEVNzl15
wYX1hRh5dOgt82myYyH8bvad7zug6tmIvlhi2rKWjGyMP5j4WtAy9fpsNH5f
4HmyhOzMxs+PPP1ezlD5HHRH6HJGJqh8Dias+qLxkUnDfA7mTNXknyklO3NQ
+2pW5+fhZI0WPa1b/A5PJkOLY3t8Yzx8VF6LaF3v2+e+/71T8lps8AnNfLuN
rMnFD3WvB7vd+a8wchH6dI+tdibZkYutFy/EaSeQnblYYVvp9t0vw8znYfiZ
oh2HT5CRhzkpGaGvHSQ78pDnfuNe8Fyy8/Hryzomj3hO5fOxdsMoU727yuej
4Nehi+f+/Rvz+Rg+UXzE7x9kZz7cYtsWfvYpWVOAlPA1c5a1kFGA+B9dHh7f
qvIFuLJ6adTpqVeYL8C6qz9s+tKPrCnEg42Fhs6zl5kvxKy2eF3DYbKjEDrD
3s6Zm8nOQsRNG7NvuSdZU4Sj3WPvawcuMV+Ev9uXtEU3DTBfhAXzV7xvzyQ7
i7CsL3zafG+yphgb2gYHEpf0M1+Mvn9uvf91BNlRjCTfoOuRLmRnMT7Q5u13
hPQwX4L6q4ueavz8R+ZLcNs4uzXrSjfzJahzCw/rtZKdJfhT687re7vPM1+K
5uG6CB9LF/OleGFHe1f/OLKjFKPvNXuc/Og086XwX5Mas83QznwZjqYOFNwM
Psx8Ga59OP33kPxDzJfhlOeh3RdeOsB8GbboEybu2b2P+XJMMS4Pe6euifly
eBfvj2pa/ckRyZej3fCkHi/5cmyXvLCmAl3y/sKowKD4hR0VOCOfj/kKTJXP
z3wlvOT7MV+JGfL9ma/Eerk+zFfiTbl+zOvgkOsrHKjDPbn+fD8dXpH7I6zT
4V25f3x/nbq/wtt16JX7T58Om+T5EO7XYYk8P/RXIU2eL/qr8JU8f/RXoUOe
T/qrMFeeX/qrUCHPN/1ViJXnn/4qPJT1QX8V1sv6oV+Py7K+6NcjRtYf/Xok
yvqkX4/hmCfrl349Hsj6pl+PBbL+6ddjuewP9OtxV/YP+g3IlP2FfgMg+w/9
BmhGPdmf6DfgVdm/6Deo/Y1+A8Jk/6PfgNOyP9JvwGbZP+k3Yp7sr/Qb8a3s
vxC/ERdlfxbWGdX+LewwIkb2d+HtRkyS/V/YaUSXnA/C/UbckvNDWGPCSjlf
hANNCJbzh34TIOcT/Sb4yvlFvwlPy/lGvwnucv7Rb8JCOR/pN8Eg5yf9ZuyR
85V+M9zl/KXfjEtyPtNvRpec3/Sb1flOvxkb5fyn3wwv6Q/oN2Op9A/0V8ND
+gv6q2GW/oP+avRJf0J/Nc5I/0J/NVqkv6G/GpOk/6G/GmOlP6K/Gq9I/0S/
BfOkv6LfgqnSf9FvgVX6M/otSJH+jX4LJkh/R78Ft6T/o9+CBukP6bcgQvpH
+q1wlf6SfqvqP+m3Ik76U/qt2CL9K/1WXJX+ln4rbNL/0m9V/TH9VgRJ/0y/
DWOlv6bfhnvSf9NvQ6n05/TboJf+nX4bAqW/p9+G16X/p9+GN2Q+oN+GPJkf
6LfDLvMF/XboZf6g346vZD6h346/yfxC/+PXy3xDv13NP/Tb8ZvMR/Tb0Svz
E/01aJP5iv4aJMn8RX8Nrsl8Rn8NNsr8Rv9jlvmO/hoEyPxHfw3ek/mQ/hq0
yPxIfy2OyXxJfy2SZf7E/wAjqjn2
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"n\"", TraditionalForm], 
    FormBox[
    "\"\\!\\(\\*SubscriptBox[\\(T\\), \\(n\\)]\\)\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotLabel->FormBox[
   "\"Eigenvalues of the kinetic part \\n of the Hamiltonian: \
self-similarity.\"", TraditionalForm],
  PlotRange->{{0., 233.}, {-3.297485362063217, 3.2974853620632154`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.627636772255084*^9, 3.627636834122182*^9}, {
   3.627636927491984*^9, 3.627636933613858*^9}, {3.6276369794744787`*^9, 
   3.627637048560357*^9}, {3.627637089686977*^9, 3.627637097515329*^9}, 
   3.627637147231167*^9}],

Cell[BoxData["\<\"/home/nicolas/git/dynamics_classical_qp_chain/data/kinetic_\
self_similar.pdf\"\>"], "Output",
 CellChangeTimes->{{3.627636772255084*^9, 3.627636834122182*^9}, {
   3.627636927491984*^9, 3.627636933613858*^9}, {3.6276369794744787`*^9, 
   3.627637048560357*^9}, {3.627637089686977*^9, 3.627637097515329*^9}, 
   3.627637147392252*^9}]
}, Open  ]]
},
WindowSize->{1280, 965},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 174, 4, 32, "Input"],
Cell[735, 26, 597, 16, 88, "Input"],
Cell[1335, 44, 4297, 110, 363, "Input"],
Cell[5635, 156, 413, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[6073, 169, 956, 22, 77, "Input"],
Cell[7032, 193, 4885, 91, 267, "Output"],
Cell[11920, 286, 858, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12815, 303, 153, 4, 39, "Input"],
Cell[12971, 309, 776, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13784, 324, 167, 4, 32, "Input"],
Cell[13954, 330, 139, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14130, 337, 4066, 115, 407, "Input"],
Cell[18199, 454, 3900, 77, 278, "Output"],
Cell[22102, 533, 352, 5, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
